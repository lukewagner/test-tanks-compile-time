<!doctype html>
<html>
    <head>
        <meta charset="utf8">
    </head>
    <body>
        <button onclick="testNonStreaming()">Fetch then Instantiate</button>
        <button onclick="testStreaming()">Streaming Instantiate</button>
        <input type="checkbox" id="cacheable" checked>
        <label for="cacheable">Cacheable</label>
        <hr>
        <div id="out"></div>
        <script>
            const tanksURL = 'tanks.wasm';
            const tanksMB = 12.379657;
            const out = document.getElementById('out');
            const cacheable = document.getElementById('cacheable');

            function roundPretty(x) {
                return Math.round(x * 10) / 10;
            }
            function printRate(what, t) {
                out.innerHTML += `${what} took ${roundPretty(t)}ms (${roundPretty(tanksMB / (t / 1000))}MB/s)<br>`;
            }
            function getURL() {
                return tanksURL + (cacheable.checked ? '' : '?id=' + Math.ceil(Math.random()*100000))
            }
            function makeDummyImportObject() {
              const dummyFunc = () => {};
              return ({ env: { memory: new WebAssembly.Memory({initial:768, maximum:768}), table: new WebAssembly.Table({initial:42924, maximum:42924, element:"anyfunc"}), DYNAMICTOP_PTR:0, STACKTOP:0, STACK_MAX:0, memoryBase:0, tableBase:0, abort: dummyFunc, assert: dummyFunc, enlargeMemory: dummyFunc, getTotalMemory: dummyFunc, abortOnCannotGrowMemory: dummyFunc, invoke_viiifiii: dummyFunc, invoke_diji: dummyFunc, invoke_diddi: dummyFunc, invoke_viij: dummyFunc, invoke_fiff: dummyFunc, invoke_fifi: dummyFunc, invoke_vijjiiiiii: dummyFunc, invoke_iiiiiii: dummyFunc, invoke_vidi: dummyFunc, invoke_vifiiiiiiiiiiiiiiiiii: dummyFunc, invoke_viiiiiiiiiii: dummyFunc, invoke_fff: dummyFunc, invoke_iidi: dummyFunc, invoke_viffffiiii: dummyFunc, invoke_jiji: dummyFunc, invoke_fiiiiiifiiiiiif: dummyFunc, invoke_iiiiifiiiif: dummyFunc, invoke_iiiiifii: dummyFunc, invoke_viiiiiffi: dummyFunc, invoke_viifiiii: dummyFunc, invoke_viiijiii: dummyFunc, invoke_iiiiifiii: dummyFunc, invoke_iiffi: dummyFunc, invoke_jii: dummyFunc, invoke_iiiiiiiiiiii: dummyFunc, invoke_fif: dummyFunc, invoke_viiiiiiiiiiiiiii: dummyFunc, invoke_fii: dummyFunc, invoke_viiiiiifiii: dummyFunc, invoke_viiiiifii: dummyFunc, invoke_di: dummyFunc, invoke_viff: dummyFunc, invoke_iiifiii: dummyFunc, invoke_viiiiifi: dummyFunc, invoke_viffff: dummyFunc, invoke_jijji: dummyFunc, invoke_vfff: dummyFunc, invoke_viiji: dummyFunc, invoke_vififfi: dummyFunc, invoke_viiiiijiiii: dummyFunc, invoke_iiijjii: dummyFunc, invoke_viiffiii: dummyFunc, invoke_dii: dummyFunc, invoke_viififfii: dummyFunc, invoke_iifii: dummyFunc, invoke_didi: dummyFunc, invoke_iiiiiiiiii: dummyFunc, invoke_iidii: dummyFunc, invoke_iiiij: dummyFunc, invoke_iiiiiiiiiiiiffffii: dummyFunc, invoke_vdd: dummyFunc, invoke_fiiifii: dummyFunc, invoke_viiiiiiffii: dummyFunc, invoke_viffii: dummyFunc, invoke_iiiiiiii: dummyFunc, invoke_vffff: dummyFunc, invoke_iijjii: dummyFunc, invoke_vdddddd: dummyFunc, invoke_vifiiiiiiiiiiiii: dummyFunc, invoke_iiiji: dummyFunc, invoke_viiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiii: dummyFunc, invoke_viiifii: dummyFunc, invoke_iiiiiiif: dummyFunc, invoke_vififi: dummyFunc, invoke_ijj: dummyFunc, invoke_viiiffi: dummyFunc, invoke_iiiii: dummyFunc, invoke_fiffi: dummyFunc, invoke_iiifii: dummyFunc, invoke_viiiiiiiiiiiiiiiii: dummyFunc, invoke_jiijiii: dummyFunc, invoke_iiiiiiiiiiiiii: dummyFunc, invoke_jijjji: dummyFunc, invoke_vifiiiiiiiiiiiiiiiiiiiiiiiiiiii: dummyFunc, invoke_viffi: dummyFunc, invoke_iiiifiiii: dummyFunc, invoke_vifi: dummyFunc, invoke_viijj: dummyFunc, invoke_vifff: dummyFunc, invoke_viiiiii: dummyFunc, invoke_viiiiiiiiiiiiii: dummyFunc, invoke_fiii: dummyFunc, invoke_iiiiiifffiiifii: dummyFunc, invoke_iifff: dummyFunc, invoke_iifiii: dummyFunc, invoke_fiif: dummyFunc, invoke_iiijii: dummyFunc, invoke_iiiiifiif: dummyFunc, invoke_jidi: dummyFunc, invoke_ji: dummyFunc, invoke_vifiiiii: dummyFunc, invoke_viiiiiiiiii: dummyFunc, invoke_iiiiiiffiiiiiiiiiffffiii: dummyFunc, invoke_diii: dummyFunc, invoke_viiiji: dummyFunc, invoke_fiffifi: dummyFunc, invoke_vff: dummyFunc, invoke_viijijiii: dummyFunc, invoke_viijijji: dummyFunc, invoke_viiififi: dummyFunc, invoke_fiiii: dummyFunc, invoke_iiiiii: dummyFunc, invoke_viiiifii: dummyFunc, invoke_vijii: dummyFunc, invoke_jidji: dummyFunc, invoke_viidii: dummyFunc, invoke_vjji: dummyFunc, invoke_iiiiiifiif: dummyFunc, invoke_viiii: dummyFunc, invoke_jijii: dummyFunc, invoke_viiiii: dummyFunc, invoke_viifii: dummyFunc, invoke_iifffi: dummyFunc, invoke_vif: dummyFunc, invoke_vid: dummyFunc, invoke_vij: dummyFunc, invoke_vii: dummyFunc, invoke_vijji: dummyFunc, invoke_viiiifiii: dummyFunc, invoke_difi: dummyFunc, invoke_fi: dummyFunc, invoke_viidi: dummyFunc, invoke_viifif: dummyFunc, invoke_fiji: dummyFunc, invoke_jiiiiiii: dummyFunc, invoke_vf: dummyFunc, invoke_iiiiiiffiiiiiiiiiiiiiii: dummyFunc, invoke_fiiiiiiiifiiiif: dummyFunc, invoke_viffffii: dummyFunc, invoke_vifiii: dummyFunc, invoke_viijjii: dummyFunc, invoke_iijjji: dummyFunc, invoke_diiii: dummyFunc, invoke_iiifiiii: dummyFunc, invoke_viiiiiiiiiiiii: dummyFunc, invoke_iiiiiiiiiiffffii: dummyFunc, invoke_iiiiifi: dummyFunc, invoke_fifii: dummyFunc, invoke_viji: dummyFunc, invoke_viiiiiiii: dummyFunc, invoke_fiffifffi: dummyFunc, invoke_viiff: dummyFunc, invoke_iif: dummyFunc, invoke_vifiiii: dummyFunc, invoke_viiiiiii: dummyFunc, invoke_vijiji: dummyFunc, invoke_vifii: dummyFunc, invoke_viiiiiiiii: dummyFunc, invoke_viijji: dummyFunc, invoke_iii: dummyFunc, invoke_viifiii: dummyFunc, invoke_iij: dummyFunc, invoke_viiijiiiiii: dummyFunc, invoke_iiiifii: dummyFunc, invoke_viiffii: dummyFunc, invoke_f: dummyFunc, invoke_jiiii: dummyFunc, invoke_viijii: dummyFunc, invoke_viiiifiiiiif: dummyFunc, invoke_viififi: dummyFunc, invoke_viii: dummyFunc, invoke_viiiifi: dummyFunc, invoke_jiii: dummyFunc, invoke_iiji: dummyFunc, invoke_viif: dummyFunc, invoke_vijiii: dummyFunc, invoke_fiiifi: dummyFunc, invoke_iiiifi: dummyFunc, invoke_v: dummyFunc, invoke_vd: dummyFunc, invoke_viifi: dummyFunc, invoke_fiifi: dummyFunc, invoke_vi: dummyFunc, invoke_iiiiiiiiiii: dummyFunc, invoke_iiiiiiiffiiiiiiiiiffffiiii: dummyFunc, invoke_vijj: dummyFunc, invoke_ii: dummyFunc, invoke_vifffi: dummyFunc, invoke_iijji: dummyFunc, invoke_iiiiifiiiiii: dummyFunc, invoke_iiiiifiiiiif: dummyFunc, invoke_jifi: dummyFunc, invoke_viiiiiiiiiiii: dummyFunc, invoke_iifi: dummyFunc, invoke_viiif: dummyFunc, invoke_fifffi: dummyFunc, invoke_jiiiii: dummyFunc, invoke_vifiiiiiiiiiiiiiiiiiiiiiii: dummyFunc, invoke_iiiffii: dummyFunc, invoke_vijiijiii: dummyFunc, invoke_iiifi: dummyFunc, invoke_iiii: dummyFunc, invoke_fidi: dummyFunc, invoke_iiij: dummyFunc, invoke_viifff: dummyFunc, invoke_viiffi: dummyFunc, invoke_iiif: dummyFunc, invoke_viffiii: dummyFunc, invoke_diiiii: dummyFunc, invoke_viiifi: dummyFunc, invoke_fiiffi: dummyFunc, invoke_iiiiiiffiiiiiiiiiffffiiii: dummyFunc, invoke_iiiiiiiiiiiii: dummyFunc, invoke_viifffi: dummyFunc, invoke_vifffii: dummyFunc, invoke_iiiifiii: dummyFunc, invoke_ff: dummyFunc, invoke_iiiifiiiii: dummyFunc, invoke_iijii: dummyFunc, invoke_iiiiiiiiiiiiiii: dummyFunc, invoke_vfi: dummyFunc, invoke_i: dummyFunc, invoke_iiidii: dummyFunc, invoke_viiifiiiii: dummyFunc, invoke_viiiiifffi: dummyFunc, invoke_iiiiiijii: dummyFunc, invoke_viijjji: dummyFunc, invoke_iiiiiiiii: dummyFunc, invoke_viffffi: dummyFunc, _emscripten_glGetTexParameterfv: dummyFunc, _glClearStencil: dummyFunc, ___syscall220: dummyFunc, _emscripten_glBlendFuncSeparate: dummyFunc, _glTexParameteriv: dummyFunc, _glUniformMatrix4fv: dummyFunc, ___assert_fail: dummyFunc, _glVertexAttrib4f: dummyFunc, _emscripten_glDepthFunc: dummyFunc, _emscripten_webgl_create_context: dummyFunc, _pthread_key_delete: dummyFunc, _glDisableVertexAttribArray: dummyFunc, _emscripten_memcpy_big: dummyFunc, _pthread_attr_init: dummyFunc, _emscripten_glUniform1f: dummyFunc, _Mix_PlayMusic: dummyFunc, ___syscall221: dummyFunc, _glInvalidateFramebuffer: dummyFunc, _emscripten_glVertexAttrib2f: dummyFunc, _emscripten_glUniform1i: dummyFunc, _emscripten_glGetIntegerv: dummyFunc, _emscripten_glIsProgram: dummyFunc, _glGenSamplers: dummyFunc, _emscripten_webgl_make_context_current: dummyFunc, _glEndTransformFeedback: dummyFunc, _glFramebufferRenderbuffer: dummyFunc, _gmtime_r: dummyFunc, _emscripten_glTexParameteriv: dummyFunc, ___syscall140: dummyFunc, ___syscall145: dummyFunc, ___syscall146: dummyFunc, _glUniform1uiv: dummyFunc, _emscripten_glAttachShader: dummyFunc, _emscripten_get_now_is_monotonic: dummyFunc, _pthread_cond_timedwait: dummyFunc, _emscripten_glTexParameterfv: dummyFunc, _pthread_attr_destroy: dummyFunc, _emscripten_glUniformMatrix2fv: dummyFunc, _SDL_GetTicks: dummyFunc, _emscripten_glDrawArraysInstanced: dummyFunc, ___syscall183: dummyFunc, _glDepthMask: dummyFunc, _emscripten_glVertexAttrib2fv: dummyFunc, _glViewport: dummyFunc, _emscripten_glFlush: dummyFunc, _glBufferData: dummyFunc, ___syscall91: dummyFunc, _pthread_once: dummyFunc, _glDrawArraysInstanced: dummyFunc, _JS_Sound_SetListenerOrientation: dummyFunc, _emscripten_glGetAttribLocation: dummyFunc, _glBeginQuery: dummyFunc, _glAttachShader: dummyFunc, _emscripten_glTexCoordPointer: dummyFunc, _emscripten_set_blur_callback: dummyFunc, _emscripten_glLoadMatrixf: dummyFunc, _emscripten_glStencilFuncSeparate: dummyFunc, _emscripten_glVertexAttrib3f: dummyFunc, _emscripten_webgl_enable_extension: dummyFunc, _glCullFace: dummyFunc, _emscripten_get_gamepad_status: dummyFunc, _sched_yield: dummyFunc, _JS_Eval_OpenURL: dummyFunc, _glCompressedTexImage2D: dummyFunc, _emscripten_glUniform1iv: dummyFunc, emscriptenWebGLGetUniform: dummyFunc, _glClearColor: dummyFunc, _glFinish: dummyFunc, _emscripten_glUniform3iv: dummyFunc, _emscripten_glGetBufferParameteriv: dummyFunc, _emscripten_glVertexAttrib4fv: dummyFunc, _glGetTexParameteriv: dummyFunc, _pthread_getspecific: dummyFunc, _glDrawArrays: dummyFunc, _pthread_cond_signal: dummyFunc, _emscripten_glDepthRange: dummyFunc, _glActiveTexture: dummyFunc, _emscripten_asm_const_iii: dummyFunc, _emscripten_glCopyTexImage2D: dummyFunc, _emscripten_glFramebufferTexture2D: dummyFunc, _glEnableVertexAttribArray: dummyFunc, _emscripten_glStencilFunc: dummyFunc, _glBindVertexArray: dummyFunc, _glVertexAttribIPointer: dummyFunc, _glDeleteBuffers: dummyFunc, _localtime: dummyFunc, _glGetUniformBlockIndex: dummyFunc, _glGetActiveUniformBlockName: dummyFunc, _glRenderbufferStorageMultisample: dummyFunc, _glCompressedTexSubImage2D: dummyFunc, _emscripten_glRenderbufferStorage: dummyFunc, emscriptenWebGLComputeImageSize: dummyFunc, _emscripten_set_keydown_callback: dummyFunc, _emscripten_glVertexPointer: dummyFunc, _JS_SystemInfo_GetHeight: dummyFunc, _emscripten_glBufferSubData: dummyFunc, _emscripten_glGetUniformfv: dummyFunc, _SDL_FreeRW: dummyFunc, _glFramebufferTextureLayer: dummyFunc, _glDeleteQueries: dummyFunc, _Mix_LoadWAV_RW: dummyFunc, _emscripten_glStencilOp: dummyFunc, _emscripten_glBlendEquation: dummyFunc, _glTexImage3D: dummyFunc, emscriptenWebGLGetIndexed: dummyFunc, _emscripten_glVertexAttrib1fv: dummyFunc, _TTF_SizeText: dummyFunc, _emscripten_glDeleteBuffers: dummyFunc, _glLinkProgram: dummyFunc, _emscripten_glGetProgramInfoLog: dummyFunc, _emscripten_glUniform4fv: dummyFunc, ___cxa_throw: dummyFunc, _JS_SystemInfo_GetCurrentCanvasWidth: dummyFunc, _glUniform1iv: dummyFunc, _emscripten_glUniform2fv: dummyFunc, _emscripten_glBindBuffer: dummyFunc, _emscripten_glGetFloatv: dummyFunc, _pthread_mutex_init: dummyFunc, _glBlendEquationSeparate: dummyFunc, _glTexSubImage2D: dummyFunc, _glUseProgram: dummyFunc, _glUniformMatrix3fv: dummyFunc, _emscripten_glCullFace: dummyFunc, _glBindTransformFeedback: dummyFunc, _emscripten_glStencilMaskSeparate: dummyFunc, _emscripten_glUniform3fv: dummyFunc, _glBindBuffer: dummyFunc, _emscripten_request_fullscreen: dummyFunc, _JS_Sound_Play: dummyFunc, _emscripten_glDisableVertexAttribArray: dummyFunc, _TTF_RenderText_Solid: dummyFunc, _glPolygonOffset: dummyFunc, _emscripten_webgl_get_current_context: dummyFunc, _emscripten_set_touchstart_callback: dummyFunc, _JS_Sound_SetListenerPosition: dummyFunc, _emscripten_glGetBooleanv: dummyFunc, _glProgramBinary: dummyFunc, _emscripten_glVertexAttribDivisor: dummyFunc, _JS_Eval_SetTimeout: dummyFunc, _glDrawElementsInstanced: dummyFunc, _emscripten_glDeleteObjectARB: dummyFunc, _emscripten_glUniform4f: dummyFunc, _emscripten_glGetShaderPrecisionFormat: dummyFunc, _JS_SystemInfo_GetLanguage: dummyFunc, _emscripten_glIsEnabled: dummyFunc, _JS_SystemInfo_HasFullscreen: dummyFunc, _emscripten_glStencilOpSeparate: dummyFunc, _JS_Sound_Set3D: dummyFunc, _pthread_cleanup_pop: dummyFunc, _glGenerateMipmap: dummyFunc, _JS_Sound_SetPosition: dummyFunc, ___syscall122: dummyFunc, ___cxa_find_matching_catch: dummyFunc, _JS_SystemInfo_HasCursorLock: dummyFunc, _emscripten_glClear: dummyFunc, _glDrawElements: dummyFunc, _JS_WebRequest_Send: dummyFunc, _emscripten_glValidateProgram: dummyFunc, _emscripten_glUniform4iv: dummyFunc, ___setErrNo: dummyFunc, _glStencilOpSeparate: dummyFunc, _JS_WebRequest_Abort: dummyFunc, ___resumeException: dummyFunc, _emscripten_glBlendFunc: dummyFunc, _mktime: dummyFunc, _emscripten_glGetError: dummyFunc, _emscripten_glBufferData: dummyFunc, _emscripten_glStencilMask: dummyFunc, _glGenTextures: dummyFunc, _glGetIntegerv: dummyFunc, _glUniform3iv: dummyFunc, _emscripten_glClearStencil: dummyFunc, _JS_Sound_Stop: dummyFunc, emscriptenWebGLGet: dummyFunc, _emscripten_set_mouseup_callback: dummyFunc, _emscripten_glFinish: dummyFunc, _emscripten_glClearDepth: dummyFunc, _emscripten_glUniform1fv: dummyFunc, _glBindFramebuffer: dummyFunc, _glValidateProgram: dummyFunc, _glGenFramebuffers: dummyFunc, _SDL_UpperBlitScaled: dummyFunc, _emscripten_glUniform4i: dummyFunc, _glUniform1fv: dummyFunc, _llvm_pow_f64: dummyFunc, __emscripten_sample_gamepad_data: dummyFunc, _glDeleteFramebuffers: dummyFunc, _JS_FileSystem_Sync: dummyFunc, _IMG_Load: dummyFunc, _glCheckFramebufferStatus: dummyFunc, _JS_WebRequest_GetStatusLine: dummyFunc, _emscripten_glCreateShader: dummyFunc, _glGetProgramBinary: dummyFunc, ___syscall192: dummyFunc, _glProgramParameteri: dummyFunc, _localtime_r: dummyFunc, _glBindTexture: dummyFunc, _strftime: dummyFunc, _emscripten_glGetVertexAttribiv: dummyFunc, _glReadPixels: dummyFunc, _glGetActiveAttrib: dummyFunc, _emscripten_glUniformMatrix3fv: dummyFunc, _glUniform2iv: dummyFunc, ___syscall33: dummyFunc, _pthread_key_create: dummyFunc, _emscripten_glDeleteFramebuffers: dummyFunc, __setLetterbox: dummyFunc, ___syscall39: dummyFunc, ___syscall38: dummyFunc, _getpwuid: dummyFunc, _glFrontFace: dummyFunc, _emscripten_glGetObjectParameterivARB: dummyFunc, _glGetUniformiv: dummyFunc, _JS_SystemInfo_HasWebGL: dummyFunc, _emscripten_glGetUniformiv: dummyFunc, _glGetActiveUniformBlockiv: dummyFunc, _glGetProgramiv: dummyFunc, ___syscall168: dummyFunc, _glScissor: dummyFunc, _emscripten_glClearColor: dummyFunc, _glGetFramebufferAttachmentParameteriv: dummyFunc, _difftime: dummyFunc, _emscripten_set_mousemove_callback: dummyFunc, _glBlitFramebuffer: dummyFunc, _emscripten_glDeleteTextures: dummyFunc, _emscripten_exit_fullscreen: dummyFunc, _glGetShaderiv: dummyFunc, _glBindBufferBase: dummyFunc, _glUniform4fv: dummyFunc, _glTexSubImage3D: dummyFunc, __exit: dummyFunc, _IMG_Load_RW: dummyFunc, _glBindAttribLocation: dummyFunc, _emscripten_glColorMask: dummyFunc, _emscripten_webgl_destroy_context: dummyFunc, _emscripten_glBindTexture: dummyFunc, _glDeleteSamplers: dummyFunc, _glUniform4iv: dummyFunc, _emscripten_set_main_loop: dummyFunc, _glUniformBlockBinding: dummyFunc, _emscripten_glIsShader: dummyFunc, _emscripten_glCompressedTexImage2D: dummyFunc, _glDisable: dummyFunc, _emscripten_glGetInfoLogARB: dummyFunc, _emscripten_longjmp: dummyFunc, _atexit: dummyFunc, _glFenceSync: dummyFunc, _glStencilFuncSeparate: dummyFunc, _JS_Sound_ReleaseInstance: dummyFunc, _emscripten_glGenRenderbuffers: dummyFunc, _JS_SystemInfo_GetCurrentCanvasHeight: dummyFunc, _JS_WebRequest_GetResponseHeaders: dummyFunc, _emscripten_glReleaseShaderCompiler: dummyFunc, __ZN4FMOD13DSPConnection6setMixEf: dummyFunc, _flock: dummyFunc, _SDL_RWFromFile: dummyFunc, _glUniform2fv: dummyFunc, _emscripten_glFrontFace: dummyFunc, _glDeleteProgram: dummyFunc, __ZSt18uncaught_exceptionv: dummyFunc, _glBlendEquation: dummyFunc, _emscripten_glUseProgram: dummyFunc, _glCreateProgram: dummyFunc, _clock_gettime: dummyFunc, _emscripten_set_touchmove_callback: dummyFunc, _glGetAttribLocation: dummyFunc, _Mix_PlayChannel: dummyFunc, _glCreateShader: dummyFunc, _emscripten_glReadPixels: dummyFunc, _sysconf: dummyFunc, _utime: dummyFunc, _glEndQuery: dummyFunc, _pthread_mutexattr_settype: dummyFunc, _glTexStorage2D: dummyFunc, _glGenBuffers: dummyFunc, _glShaderSource: dummyFunc, _emscripten_glScissor: dummyFunc, _glUniform3uiv: dummyFunc, _pthread_cleanup_push: dummyFunc, _llvm_trap: dummyFunc, _JS_Sound_SetVolume: dummyFunc, _JS_Cursor_SetShow: dummyFunc, _glPixelStorei: dummyFunc, _emscripten_glIsBuffer: dummyFunc, _emscripten_glVertexAttrib1f: dummyFunc, _glVertexAttribPointer: dummyFunc, _emscripten_glCompressedTexSubImage2D: dummyFunc, _glSamplerParameteri: dummyFunc, _glBindSampler: dummyFunc, _JS_WebRequest_Release: dummyFunc, _emscripten_get_main_loop_timing: dummyFunc, _glGetVertexAttribiv: dummyFunc, _JS_Log_Dump: dummyFunc, _emscripten_glGetAttachedShaders: dummyFunc, _emscripten_glGenTextures: dummyFunc, _JS_Cursor_SetCursorString: dummyFunc, _glBindRenderbuffer: dummyFunc, _pthread_cond_init: dummyFunc, _SDL_LockSurface: dummyFunc, _gmtime: dummyFunc, _emscripten_glGetTexParameteriv: dummyFunc, _glDeleteTextures: dummyFunc, _emscripten_set_mousedown_callback: dummyFunc, _Mix_HaltMusic: dummyFunc, _emscripten_glClientActiveTexture: dummyFunc, _emscripten_glCheckFramebufferStatus: dummyFunc, _emscripten_glUniform3f: dummyFunc, _emscripten_glUniform3i: dummyFunc, _glDrawBuffers: dummyFunc, _emscripten_glDeleteShader: dummyFunc, _glEnable: dummyFunc, _glUnmapBuffer: dummyFunc, _glGetString: dummyFunc, _emscripten_glGetUniformLocation: dummyFunc, _emscripten_glEnableVertexAttribArray: dummyFunc, _emscripten_get_now: dummyFunc, _emscripten_glGenFramebuffers: dummyFunc, emscriptenWebGLGetTexPixelData: dummyFunc, _gettimeofday: dummyFunc, ___syscall202: dummyFunc, _emscripten_glEnableClientState: dummyFunc, _JS_Sound_Init: dummyFunc, _TTF_FontHeight: dummyFunc, _emscripten_glDrawElements: dummyFunc, _emscripten_get_num_gamepads: dummyFunc, ___buildEnvironment: dummyFunc, _glClearDepthf: dummyFunc, _tzset: dummyFunc, _glIsEnabled: dummyFunc, _emscripten_glDisable: dummyFunc, _emscripten_glDeleteRenderbuffers: dummyFunc, _emscripten_glDrawElementsInstanced: dummyFunc, _emscripten_glVertexAttrib4f: dummyFunc, _JS_Sound_Create_Channel: dummyFunc, _emscripten_glPixelStorei: dummyFunc, _llvm_fabs_f32: dummyFunc, _glCopyBufferSubData: dummyFunc, _getenv: dummyFunc, _emscripten_glFramebufferRenderbuffer: dummyFunc, _glReadBuffer: dummyFunc, _emscripten_glRotatef: dummyFunc, _emscripten_glGetShaderiv: dummyFunc, _JS_Eval_ClearTimeout: dummyFunc, ___cxa_pure_virtual: dummyFunc, _emscripten_glUniformMatrix4fv: dummyFunc, _emscripten_glGetPointerv: dummyFunc, _pthread_cond_wait: dummyFunc, _clock: dummyFunc, _emscripten_glIsRenderbuffer: dummyFunc, _emscripten_request_pointerlock: dummyFunc, ___syscall40: dummyFunc, ___syscall42: dummyFunc, _emscripten_set_touchcancel_callback: dummyFunc, _glDeleteRenderbuffers: dummyFunc, _glGetShaderPrecisionFormat: dummyFunc, _JS_SystemInfo_GetMemory: dummyFunc, _JS_Sound_SetLoop: dummyFunc, _JS_WebRequest_SetResponseHandler: dummyFunc, _emscripten_set_focus_callback: dummyFunc, _pthread_mutexattr_destroy: dummyFunc, _emscripten_glGetVertexAttribfv: dummyFunc, _SDL_PauseAudio: dummyFunc, _emscripten_glVertexAttrib3fv: dummyFunc, _glGetUniformLocation: dummyFunc, _emscripten_glCompileShader: dummyFunc, _glClear: dummyFunc, _glBeginTransformFeedback: dummyFunc, __arraySum: dummyFunc, _emscripten_glLinkProgram: dummyFunc, _JS_WebRequest_Create: dummyFunc, _emscripten_get_pointerlock_status: dummyFunc, _emscripten_glDrawRangeElements: dummyFunc, ___unlock: dummyFunc, _pthread_create: dummyFunc, _glGetActiveUniformsiv: dummyFunc, _pthread_setspecific: dummyFunc, _glColorMask: dummyFunc, _emscripten_glGenBuffers: dummyFunc, _glCopyTexSubImage2D: dummyFunc, _emscripten_glCreateProgram: dummyFunc, _JS_WebRequest_SetProgressHandler: dummyFunc, _glTexParameteri: dummyFunc, _pthread_cond_destroy: dummyFunc, _emscripten_glDetachShader: dummyFunc, _SDL_RWFromConstMem: dummyFunc, _glTexParameterf: dummyFunc, _setenv: dummyFunc, _emscripten_do_request_fullscreen: dummyFunc, _glGenQueries: dummyFunc, _emscripten_glGetRenderbufferParameteriv: dummyFunc, _emscripten_set_fullscreenchange_callback: dummyFunc, _emscripten_glVertexAttribPointer: dummyFunc, _glTexStorage3D: dummyFunc, _glIsVertexArray: dummyFunc, _JS_SystemInfo_GetBrowserName: dummyFunc, _emscripten_glDrawArrays: dummyFunc, _emscripten_glPolygonOffset: dummyFunc, _longjmp: dummyFunc, _emscripten_glBlendColor: dummyFunc, _glGetShaderInfoLog: dummyFunc, _emscripten_set_main_loop_timing: dummyFunc, ___cxa_begin_catch: dummyFunc, _emscripten_glGetProgramiv: dummyFunc, _glDeleteSync: dummyFunc, __addDays: dummyFunc, _emscripten_glGetShaderSource: dummyFunc, _emscripten_glTexImage2D: dummyFunc, _glRenderbufferStorage: dummyFunc, __isLeapYear: dummyFunc, _JS_Sound_GetLength: dummyFunc, _emscripten_glBlendEquationSeparate: dummyFunc, _emscripten_glGetString: dummyFunc, _emscripten_glIsFramebuffer: dummyFunc, _glUniform2uiv: dummyFunc, _unsetenv: dummyFunc, _emscripten_glBindProgramARB: dummyFunc, _JS_Sound_SetLoopPoints: dummyFunc, _pthread_detach: dummyFunc, _emscripten_set_devicemotion_callback: dummyFunc, ___syscall85: dummyFunc, _emscripten_glUniform2i: dummyFunc, _emscripten_glUniform2f: dummyFunc, _glGenTransformFeedbacks: dummyFunc, _JS_SystemInfo_GetWidth: dummyFunc, _glGetProgramInfoLog: dummyFunc, _emscripten_glTexParameterf: dummyFunc, _emscripten_glTexParameteri: dummyFunc, _JS_Sound_Load: dummyFunc, _JS_Sound_Load_PCM: dummyFunc, _emscripten_glGenVertexArrays: dummyFunc, _llvm_cttz_i32: dummyFunc, _glDeleteVertexArrays: dummyFunc, _glGetStringi: dummyFunc, _emscripten_glBindAttribLocation: dummyFunc, _llvm_pow_f32: dummyFunc, _glDepthFunc: dummyFunc, ___cxa_allocate_exception: dummyFunc, _emscripten_set_canvas_size: dummyFunc, _emscripten_glClearDepthf: dummyFunc, _JS_SystemInfo_GetDocumentURL: dummyFunc, _emscripten_glMatrixMode: dummyFunc, _glBlendFuncSeparate: dummyFunc, ___syscall10: dummyFunc, _emscripten_glNormalPointer: dummyFunc, _emscripten_glHint: dummyFunc, _emscripten_glEnable: dummyFunc, ___syscall3: dummyFunc, ___lock: dummyFunc, _emscripten_glBindFramebuffer: dummyFunc, ___syscall6: dummyFunc, ___syscall5: dummyFunc, ___syscall4: dummyFunc, _emscripten_glBindRenderbuffer: dummyFunc, _time: dummyFunc, _emscripten_glGetFramebufferAttachmentParameteriv: dummyFunc, _emscripten_set_wheel_callback: dummyFunc, _exit: dummyFunc, _emscripten_glGetActiveAttrib: dummyFunc, _putenv: dummyFunc, ___syscall268: dummyFunc, _emscripten_set_keypress_callback: dummyFunc, _JS_SystemInfo_GetOS: dummyFunc, _glMapBufferRange: dummyFunc, _JS_SystemInfo_GetBrowserVersionString: dummyFunc, _glGetIntegeri_v: dummyFunc, _glFramebufferTexture2D: dummyFunc, _JS_Cursor_SetImage: dummyFunc, _emscripten_glShaderBinary: dummyFunc, _emscripten_glGetShaderInfoLog: dummyFunc, _glUniform3fv: dummyFunc, _emscripten_glGetVertexAttribPointerv: dummyFunc, _glClientWaitSync: dummyFunc, _JS_FileSystem_SetSyncInterval: dummyFunc, _emscripten_set_deviceorientation_callback: dummyFunc, ___syscall193: dummyFunc, _emscripten_glGetActiveUniform: dummyFunc, emscriptenWebGLGetVertexAttrib: dummyFunc, ___syscall197: dummyFunc, ___syscall196: dummyFunc, ___syscall195: dummyFunc, ___syscall194: dummyFunc, ___syscall199: dummyFunc, _emscripten_glDeleteProgram: dummyFunc, _glUniform1i: dummyFunc, _glFlushMappedBufferRange: dummyFunc, _emscripten_glTexSubImage2D: dummyFunc, _pthread_mutex_destroy: dummyFunc, _emscripten_glColorPointer: dummyFunc, _glTransformFeedbackVaryings: dummyFunc, _glGetShaderSource: dummyFunc, _emscripten_glViewport: dummyFunc, _emscripten_glDepthMask: dummyFunc, _emscripten_glDrawBuffers: dummyFunc, _emscripten_glLineWidth: dummyFunc, _glCompileShader: dummyFunc, _emscripten_exit_pointerlock: dummyFunc, _JS_WebRequest_SetRequestHeader: dummyFunc, _abort: dummyFunc, _JS_Sound_GetLoadState: dummyFunc, _glTexImage2D: dummyFunc, _glUniform4uiv: dummyFunc, _glFlush: dummyFunc, _emscripten_glLoadIdentity: dummyFunc, _glDeleteShader: dummyFunc, _emscripten_glShaderSource: dummyFunc, _glGenVertexArrays: dummyFunc, _SDL_CloseAudio: dummyFunc, ___gxx_personality_v0: dummyFunc, _emscripten_get_fullscreen_status: dummyFunc, _emscripten_set_touchend_callback: dummyFunc, _glGetError: dummyFunc, _glGenRenderbuffers: dummyFunc, _emscripten_glSampleCoverage: dummyFunc, _emscripten_glFrustum: dummyFunc, _Mix_FreeChunk: dummyFunc, _emscripten_glDepthRangef: dummyFunc, _JS_Sound_SetPitch: dummyFunc, _emscripten_glGenerateMipmap: dummyFunc, _glCopyTexImage2D: dummyFunc, _emscripten_glIsTexture: dummyFunc, _glCompressedTexSubImage3D: dummyFunc, _emscripten_glBindVertexArray: dummyFunc, _SDL_UpperBlit: dummyFunc, ___syscall51: dummyFunc, _emscripten_glActiveTexture: dummyFunc, _emscripten_set_keyup_callback: dummyFunc, _emscripten_glDeleteVertexArrays: dummyFunc, ___syscall54: dummyFunc, _glDeleteTransformFeedbacks: dummyFunc, _emscripten_glUniform2iv: dummyFunc, _pthread_mutexattr_init: dummyFunc, _glBufferSubData: dummyFunc, _emscripten_webgl_init_context_attributes: dummyFunc, _SDL_GL_SwapBuffers: dummyFunc, _emscripten_glCopyTexSubImage2D: dummyFunc, _glGetInternalformativ: dummyFunc, _glGetActiveUniform: dummyFunc, _glStencilMask: dummyFunc, tempDoublePtr: dummyFunc, ABORT: dummyFunc, cttz_i8: dummyFunc }, global: { NaN:NaN, Infinity:Infinity }, 'global.Math': Math, asm2wasm: { 'f64-to-int': dummyFunc } });
            }

            function testNonStreaming() {
                const before = performance.now();
                fetch(getURL())
                .then(response => response.arrayBuffer())
                .then(buffer => {
                    if (buffer.byteLength / 1000000 != tanksMB) { alert("Bad tanks.wasm"); }

                    const middle = performance.now();
                    WebAssembly.instantiate(buffer, makeDummyImportObject())
                    .then(() => {
                        const after = performance.now();
                        printRate("fetch() &rarr; WebAssembly.instantiate()", after - before);
                        printRate("↳ fetch()", middle - before);
                        printRate("↳ WebAssembly.instantiate()", after - middle);
                        out.innerHTML += '<hr>';
                    })
                    .catch(error => alert("Error: " + String(error)));
                });
            }

            function testStreaming() {
                const before = performance.now();
                WebAssembly.instantiateStreaming(fetch(getURL()), makeDummyImportObject())
                .then(() => {
                    const after = performance.now();
                    printRate("WebAssembly.instantiateStreaming(fetch())", after - before);
                    out.innerHTML += '<hr>';
                })
                .catch(error => alert("Error: " + String(error)));
            }
        </script>
    </body>
</html>
